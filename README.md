# LE Calculator

https://yuyuyzl.github.io/le-calculator/

一个基于 React 的可视化节点计算器，支持复杂的数学表达式计算和节点依赖关系管理。  
主要应用于多种ARPG游戏（最后纪元、暗黑破坏神等）的伤害计算和词条最大化，替代Excel表格。  


## 使用指南

### 基本操作

1. **创建节点**
   - 双击空白区域创建新节点
   - 或通过粘贴数据自动创建

2. **编辑节点**
   - 双击节点标题修改名称
   - 在输入框中输入数学表达式
   - 点击 % 切换百分比模式
   - 点击 +1 切换增量模式

3. **移动节点**
   - 拖拽节点到任意位置
   - 使用"自动布局"按钮重新排列

4. **删除节点**
   - 点击节点右上角的 X 按钮删除节点

### 表达式语法

支持标准的 JavaScript 数学表达式：

```javascript
// 基本运算
20 + 30
100 * 1.5
(50 + 30) / 2

// 变量引用
基础伤害 + 10
攻击力 * 1.2

// 复杂表达式
(基础伤害 + 附加伤害) * (1 + 暴击率 / 100)
```

### 特殊模式

- **百分比模式 (%)**: 计算结果会自动除以 100
- **增量模式 (+1)**: 计算结果会自动加 1

### 数据导入导出

#### 导出数据
点击工具栏的"保存"按钮，下载 `nodes.json` 文件

#### 导入数据
1. 点击工具栏的"载入"按钮
2. 选择 JSON 文件导入

#### 粘贴数据
支持多种格式的粘贴：

```javascript
// JSON 格式
[{"title":"攻击力","value":"100"},{"title":"防御力","value":"50"}]

// 键值对格式
攻击力: 100
防御力: 50
生命值 = 200

// 百分比格式
暴击率: 15%
```

## 功能特性

### 🎯 核心功能
- **可视化节点编辑**: 拖拽式界面，直观地创建和管理计算节点
- **智能表达式计算**: 支持复杂的数学表达式和变量引用
- **依赖关系管理**: 自动解析节点间的依赖关系，支持循环依赖检测
- **实时计算**: 输入时实时更新计算结果，最多支持 10000 次迭代
- **百分比和增量计算**: 支持百分比模式（%）和加一模式（+1）

### 🛠️ 操作功能
- **拖拽移动**: 通过鼠标拖拽自由移动节点位置
- **双击创建**: 双击空白区域快速创建新节点
- **智能粘贴**: 支持多种格式的粘贴（JSON、键值对等）
- **自动布局**: 根据依赖关系自动排列节点
- **快照对比**: 保存和对比不同时间点的计算结果
- **撤销重做**: 支持 Ctrl+Z 撤销操作

### 💾 数据管理
- **本地存储**: 自动保存到浏览器本地存储
- **导入导出**: 支持 JSON 格式的保存和载入
- **清空重置**: 一键清空所有节点数据

## 快速开始

### 环境要求
- Node.js >= 16.0.0
- npm 或 pnpm

### 安装依赖
```bash
# 使用 npm
npm install

# 或使用 pnpm
pnpm install
```

### 开发模式
```bash
npm run dev
# 或
pnpm dev
```

### 构建生产版本
```bash
npm run build
# 或
pnpm build
```

### 预览生产版本
```bash
npm run preview
# 或
pnpm preview
```


## 开发脚本

```bash
# 代码检查
npm run lint

# 自动修复代码格式
npm run lint:fix

# 代码格式化
npm run format

# 检查代码格式
npm run format:check

# 部署到 GitHub Pages
npm run deploy
```